---
layout: post
title: Use late declaration
date: '2012-01-21T17:34:00.001+01:00'
author: Luca Ferrari
tags:
- programmazione
- programming best practice
modified_time: '2012-01-21T17:34:00.157+01:00'
blogger_id: tag:blogger.com,1999:blog-1836481905487384887.post-6303458362110593194
blogger_orig_url: http://fluca1978.blogspot.com/2012/01/use-late-declaration.html
---

<div style="text-align: justify;">While developing code you will have to declare one or more variables before using it. If the language allows you to do so, <i>declare them only when you are going to use!</i>&nbsp;There are languages as C that require you to declare a variable at the begin of a code block, that could be far from when it is firstly used. There are other languages that allow you to declare a variable exactly where you are going to use it (Java, C++, Perl,...), and if possible you should get used to this habit. To explain why let us consider the following piece of pseudo Java code:</div><div style="text-align: justify;"><br /></div><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">AuthToken login( String username, String password ) throws AuthException{</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; AuthToken token;</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;"><br /></span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; if( username == null || username.isEmpty() )</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw new AuthException();</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; else if( password == null || password.isEmpty() )</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw new AuthException(); </span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; else{</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; // validate login and return a new AuthToken</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; return token;</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; }</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">}</span><br /><br /><div style="text-align: justify;"><br /></div><div style="text-align: justify;">The code is quite simple: the method receives two parameters as input, check them againsta some rules and then wrap them into another object called AuthToken that is then returned. What is wrong with such piece of code? Nothing. But that is because it is Java. Now imagine the same code expressed in C++ language. Can you see what is wrong? The AuthToken object is build immediatly as it is declared and then there are two paths that will not use it (the two path that throw an exception). In such case the object will be wasted.</div><div style="text-align: justify;">There is something more beside avoiding a memory waste: placing the variable exactly when you are going to use it makes it simpler to comment out a whole piece of code. In the above example, if you refactor the method to return a void, you have to comment out the return statement and also the variable declaration, and the two instructions are quite far. Now, while commenting out the declaration will mark the return statement as not valid, doing the vice versa will not and could lead to a situation where the code is correct even if the variable is still there.</div><div style="text-align: justify;">Finally, declaring the variable where it is going to be used makes it simpler to refactor the code introducing new code blocks, and therefore new scope contexts.</div>