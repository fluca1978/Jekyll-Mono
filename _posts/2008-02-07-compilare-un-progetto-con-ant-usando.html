---
layout: post
title: Compilare un progetto con Ant usando AspectJ in Eclipse
date: '2008-02-07T19:12:00.001+01:00'
author: Luca Ferrari
tags:
- eclipse
- java
modified_time: '2008-07-29T09:15:55.197+02:00'
blogger_id: tag:blogger.com,1999:blog-1836481905487384887.post-8558776182662736543
blogger_orig_url: http://fluca1978.blogspot.com/2008/02/compilare-un-progetto-con-ant-usando.html

permalink: /:year/:month/:day/:title.html
---


<h1>~</h1>


La configurazione di Ant per la compilazione mediante AspectJ non è sempre semplice, in particolare se si usa Ant all'interno di Eclipse. Questo articolo illustrerà brevemente i passi principali per arrivare ad avere un ambiente funzionante. Si fa riferimento a Eclipse 3.3, Ant 1.7, AspectJ 1.5; nel seguito si mostreranno pezzi di un build file completo, che non viene riportato interamente per ragioni di spazio. Le variabili utilizzate sono state nominate in modo da rendere comprensibile la lettura anche senza avere accesso alla loro definizione.<br /><br /><span style="font-weight: bold;">Definizione del Task Ant</span><br />All'interno del file di progetto occorre definire il task iajc, che è l'equivalente del task javac normalmente usato in Ant.<br /><br /><span style=";font-family:arial;font-size:85%;"  >&lt;!-- where to find the aspectj jars required for the compilation --&gt;<br />&lt;property name="aspectj.tools" value="${src.lib.dir}/aspectjtools.jar"&gt; &lt;/property&gt;<br />&lt;property name="aspectj.runtime" value="${src.lib.dir}/aspectjrt.jar" &gt; &lt;/property&gt;<br /><br />&lt;!-- definition of the ant task for the compilation --&gt;<br />&lt;taskdef resource="org/aspectj/tools/ant/taskdefs/aspectjTaskdefs.properties" classpath="${aspectj.tools}"&gt;<br />&lt;/taskdef&gt;</span><br /><br />Le prime due proprietà sono definite per comodità e modularità del build file. Si ricordi che per definire il task iajc occorre il jar aspectjtools.jar, mentre per la compilazione degli aspetti occorre il jar aspectjrt.jar (che fornisce accesso alle strutture run-time di AspectJ). Una volta inserita la definizione del nuovo task si può procedere con la compilazione vera e propria. Da notare che non sempre un taskdef permette l'inclusione di elementi annidati, ecco perché a differenza della guida di AspectJ si è definito il classpath come attributo e non come elemento.<br /><br /><span style="font-weight: bold;">Definizione del classpath</span><br />E' bene definire un elemento classpath da utilizzare ovunque nel proprio file di build, indipendentement dall'utilizzo o meno di AspectJ. Di seguito vi è un esempio di classpath per un progetto che richiede alcune dipendenze esterne (driver JDBC per PostgreSQL, Hibernate, Log4J, JUnit):<br /><br /><span style=";font-family:arial;font-size:85%;"  >&lt;!-- the classpath with specific libraries required by the project --&gt;<br />&lt;path id="build.classpath"&gt;<br />&lt;pathelement location="${build.lib.dir}/aspectjrt.jar" /&gt;<br />&lt;pathelement location="${build.lib.dir}/hibernate3.jar" /&gt;<br />&lt;pathelement location="${build.lib.dir}/log4j-1.2.15.jar" /&gt;<br />&lt;pathelement location="${build.lib.dir}/postgresql-8.3-603.jdbc4.jar" /&gt;<br />&lt;pathelement location="${build.lib.dir}/junit-4.4.jar" /&gt;<br />&lt;/path&gt;<br /></span><br /><br /><span style="font-weight: bold;">Task di compilazione</span><br />E' giunto ora il momento di inserire il task di compilazione vero e proprio. Il task di compilazione, come già accennato, è chiamato iajc e prevede parametri simili a quelli del task javac. Da notare come ogni attributo path del task iajc possa essere specificato anche come elemento annidato (di tipo pathelement).<br />Di seguito la definizione del task di un task di compilazione:<br /><br /><span style="font-size:85%;"><span style="font-family:arial;">&lt;!-- AspectJ compilation of the project --&gt;<br /><br /></span><span style="font-family:arial;">&lt;target name="_AspectJCompile" depends="init" description="Compiles the project using AspectJ compiler." &gt;</span><br /><span style="font-family:arial;">&lt;iajc srcDir="${src.dir}" destDir="${build.dir}" source="1.5" classpathref="build.classpath"&gt;</span><br /><span style="font-family:arial;">&lt;/iajc&gt;</span><br /><span style="font-family:arial;">&lt;/target&gt;</span></span><br /><br />E' interessante notare come si faccia riferimento al classpath precedentemente definito e come siano impostati i percorsi sorgente e destinazione per il build. Da notare anche la compatibilità dei sorgenti (attributo source).<br /><br /><span style="font-size:130%;"><span style="font-size:100%;"><span style="font-size:130%;"><span style="font-size:100%;"><span style="font-size:130%;"><span style="font-size:100%;"><br /></span></span></span></span></span></span>