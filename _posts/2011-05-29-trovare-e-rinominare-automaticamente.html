---
layout: post
title: Trovare e rinominare automaticamente gli MP3 senza tag
date: '2011-05-29T21:52:00.000+02:00'
author: Luca Ferrari
tags:
- mp3
- linux
modified_time: '2011-05-29T21:52:49.797+02:00'
blogger_id: tag:blogger.com,1999:blog-1836481905487384887.post-7462742532004918404
blogger_orig_url: http://fluca1978.blogspot.com/2011/05/trovare-e-rinominare-automaticamente.html
---

<div style="text-align: justify;">Una cosa estremamente seccante quando sia accende il proprio lettore MP3 e' quella di trovare dei file che non sono stati taggati correttamente con id3. Per evitare questo problema ho creato un piccolo script che tagga in automatico i file che non hanno tag id3.<br />Anzitutto, per trovare i file con tag e quelli senza, e' possibile eseguire il seguente comando:<br /><br />find /media/FLUCAPOD/Music -iname '*.mp3' -type f -print0 | xargs -0 mp3info &gt; ~/mp3List.txt 2&gt;~/untaggedMp3.txt<br /><br />Il comando effettua un find (ricerca di file) sul dispositivo montato sotto /media/FLUCAPOD; la ricerca prende tutti i file con estensione mp3 e li passa uno ad uno ad un programma mp3info che visualizza le informazioni del tag stesso. La lista dei file che passano il controllo di mp3info viene inserita in mp3List.txt, mentre i file privi di tag sono memorizzati nel file untaggedMp3.txt. Quindi con il comando di cui sopra e' possibile verificare se ci sono file privi di tag sul proprio dispositivo.<br />Per inserire automaticamente i tag si puo' usare il comando lltag, che ha la comoda opzione -G (guess) che tenta di indovinare i tag dal nome del file che processa. A tal fine ho creato un piccolo shell script wrapper per lltag:<br /><span style="font-size: x-small;"><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">#!/bin/bash</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># mp3tag.sh</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">MP3_FILE=$1</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">mp3info "$MP3_FILE" &gt; /dev/null 2&gt;&amp;1</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">if [ $? -ne 0 ]</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">then</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; # file senza tag MP3</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; echo -en "Auto-tag file [$MP3_FILE]..."</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; lltag -G --yes "$MP3_FILE" &gt; /dev/null 2&gt;&amp;1</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; if [ $? -eq 0 ]</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; then</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo -en "OK!\n"</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; else</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo -en "FALLITO!\n"</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; fi</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">fi</span></span><br /><br /><br />E quindi e' possibile eseguire la ricerca dei file mp3 passando i file trovati a questo wrapper che quindi in automatico verifica se sono presenti i tag e nel caso siano assenti effettua automaticamente il tagging:<br /><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">find /media/FLUCAPOD/Music/ -iname "*.mp3" -exec mp3tag.sh {} \;</span></span><br /><br />Giusto per dare un'ordine di grandezza dei tempi di esecuzione di questa procedura, in meno di 5 minuti il sistema ha processato 2913 file per circa 30 GB di file!</div>