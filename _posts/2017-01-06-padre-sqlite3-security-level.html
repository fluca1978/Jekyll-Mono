---
layout: post
title: Padre, SQLite3, security level...
date: '2017-01-06T19:09:00.001+01:00'
author: Luca Ferrari
tags:
- perl
modified_time: '2017-01-06T19:09:51.289+01:00'
blogger_id: tag:blogger.com,1999:blog-1836481905487384887.post-5795327413251500363
blogger_orig_url: http://fluca1978.blogspot.com/2017/01/padre-sqlite3-security-level.html
---

Mentre sono ancora alle prese per riuscire ad installare l'ultimo <a href="http://padre.perlide.org/">Padre</a> da <a href="http://search.cpan.org/~plaven/Padre-1.00/lib/Padre.pm">CPAN</a> sul mio <a href="https://perlbrew.pl/">perlbrew</a> non ho resistito alla tentazione, e così ho installato la versione bundle per kubuntu...tutto semplice, no?<br />NO!<br />Ecco cosa succede se si cerca di lanciare l'IDE:<br /><br /><br />       <br /><div><span style="font-family: monospace;"><span style="background-color: white; color: black;">$ padre </span><br />DBD::SQLite::db do failed: Safety level may not be changed inside a transaction at (eval 1904) l<br />ine 37. <br />Perl exited with active threads: <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 running and unjoined <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 finished and unjoined <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 running and detached</span></div><br /><br /><br />Fortunatamente la soluzione è abbastanza semplice e nota: modificare il file <i>Locker.pm</i> e spostare la direttiva <i>pragma</i> da dopo l'inizio della transazione a subito prima, ossia<br /><br />       <br /><div><span style="font-family: monospace;"><span style="background-color: white; color: black;">$ diff -p /usr/share/perl5/Padre/Locker.pm /usr/shar</span><br />e/perl5/Padre/Locker.pm~ <br />*** /usr/share/perl5/Padre/Locker.pm &nbsp;&nbsp;&nbsp;2017-01-06 19:01:45.429692436 +0100 <br />--- /usr/share/perl5/Padre/Locker.pm~ &nbsp;&nbsp;2013-11-09 04:43:41.000000000 +0100 <br />*************** sub shutdown { <br />*** 102,108 **** <br /> &nbsp;sub db_increment { <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ( $self-&gt;{db_depth}++ ) { <br />! <br /> &nbsp;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Database operations we lock on are the most likely to <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# involve writes. So opportunistically prevent blocking <br />--- 102,108 ---- <br /> &nbsp;sub db_increment { <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ( $self-&gt;{db_depth}++ ) { <br />! &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Padre::DB-&gt;begin; <br /> &nbsp;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Database operations we lock on are the most likely to <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# involve writes. So opportunistically prevent blocking <br />*************** sub db_increment { <br />*** 110,117 **** <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# database write operations faster, at the risk of config.db <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# corruption if (and only if) there is a power outage, <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# operating system crash, or catastrophic hardware failure. <br />! &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Padre::DB-&gt;pragma( synchronous =&gt; 0 ); <br />! &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Padre::DB-&gt;begin; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return; <br /> &nbsp;} <br />--- 110,116 ---- <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# database write operations faster, at the risk of config.db <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# corruption if (and only if) there is a power outage, <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# operating system crash, or catastrophic hardware failure. <br />! &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Padre::DB-&gt;pragma( synchronous =&gt; 0 ); <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return; <br /> &nbsp;}<br /></span></div><br /><br />