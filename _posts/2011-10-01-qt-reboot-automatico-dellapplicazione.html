---
layout: post
title: 'Qt: reboot automatico dell''applicazione'
date: '2011-10-01T13:39:00.000+02:00'
author: Luca Ferrari
tags:
- c++
- qt
- programmazione
modified_time: '2011-10-01T13:39:00.760+02:00'
blogger_id: tag:blogger.com,1999:blog-1836481905487384887.post-6714621760581616150
blogger_orig_url: http://fluca1978.blogspot.com/2011/10/qt-reboot-automatico-dellapplicazione.html

permalink: /:year/:month/:day/:title.html
---


<h1>~</h1>


<div style="text-align: justify;">Una delle cose molto comode che il framework Eclipse RCP fornisce out-of-the-box è la capacità di riavviare automaticamente una applicazione. Qt non fornisce nulla del genere, ma non è difficile implementare un meccanismo per il reboot. <a href="http://developer.qt.nokia.com/wiki/ApplicationRestart">In questo articolo</a> sul Wiki ufficiale descrivo come implementare efficacemente il reboot. I passi fondamentali sono:</div><ol style="text-align: justify;"><li>creare una costante che sia associata al valore di uscita <i>reboot</i></li><li>modificare il<i>&nbsp; </i>ciclo di vita dell'applicazione (<i>main</i>) affinche' usi un loop per processare l'applicazione. Il loop non termina fino a che il valore di uscita dell'applicazione non e' diverso dal valore di reboot.</li><li>creare uno slot (ad esempio nella propria main window) per effettuare il reboot.</li><li>creare una azione per gestire il reboot e connetterla allo slot di cui sopra.</li></ol><div style="text-align: justify;">Il nuovo ciclo main (punto 2) risulta quindi simile al seguente:</div><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: x-small;">int main(int argc, char *argv[])<br />{<br />&nbsp;&nbsp;&nbsp; int currentExitCode = 0;<br /><br />&nbsp;&nbsp;&nbsp; do{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; QApplication a(argc, argv);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MainWindow w;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.show();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; currentExitCode = a.exec();<br /><br />&nbsp;&nbsp;&nbsp; }while( currentExitCode == MainWindow::EXIT_CODE_REBOOT );<br /><br />&nbsp;&nbsp;&nbsp; return currentExitCode;<br /><br />}</span></div><br />ove ovviamente EXIT_CODE_REBOOT e' la costante definita ed opportunamente inizializzata. La MainWindow avra' uno slot (punto 3) simile al seguente:<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: x-small;">void MainWindow::slotReboot()<br />{<br />&nbsp;&nbsp;&nbsp; qDebug() &lt;&lt; "Performing application reboot..";<br />&nbsp;&nbsp;&nbsp; qApp-&gt;exit( MainWindow::EXIT_CODE_REBOOT );<br />}</span></div><br />e l'azione (punto 4) che gestisce il reboot sara' come la seguente:<br /><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; actionReboot = new QAction( this );</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; actionReboot-&gt;setText( tr("Restart") );</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; actionReboot-&gt;setIcon( QIcon(":/actions/img/reboot.png" ) );</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; actionReboot-&gt;setStatusTip( tr("Restarts the application") );</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; connect( actionReboot,</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SIGNAL(triggered()),</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this,</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SLOT(slotReboot()) );</span></span>