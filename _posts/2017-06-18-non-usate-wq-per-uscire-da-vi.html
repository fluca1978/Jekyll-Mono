---
layout: post
title: Non usate :wq! per uscire da vi!
date: '2017-06-18T08:56:00.000+02:00'
author: Luca Ferrari
tags:
- emacs
- vi
modified_time: '2017-06-18T08:56:07.679+02:00'
blogger_id: tag:blogger.com,1999:blog-1836481905487384887.post-8822249742979373687
blogger_orig_url: http://fluca1978.blogspot.com/2017/06/non-usate-wq-per-uscire-da-vi.html
---

Una cosa che non capisco di Vi(m) e dei suoi utenti è la costante ed errata abitudine di usare il comando <code>q!</code> per uscire dall'editor.<br />Ho <a href="http://fluca1978.blogspot.it/2015/10/il-modo-corretto-di-uscire-da-vim.html">già scritto in precedenza riguardo questo soggetto</a>, ma sono incappato in una innocente immagine di un minicorso del linguaggio C che, ancora una volta, insegna a chi è alle prime armi ad uscire da Vi con la combinazione <i>mortale</i> <code>:wq!</code> (<a href="https://lleksah.files.wordpress.com/2017/06/cuno.png?w=640&amp;h=480">qui l'immagine</a> del <a href="https://lleksah.wordpress.com/2017/06/03/running-your-first-programs-in-c-part-2/">post</a>).<br /><br /><br />Vediamo di approfondire ancora una volta.<br />Anzitutto cosa suggerisce l'aiuto in linea di Vi? Eseguendo <code>:help</code> si ottiene qualcosa del genere:<br /><br /><br /><pre class="example">*help.txt*      For Vim version 7.4.  Last change: 2016 Mar 31<br /><br />                        VIM - main help file<br />                                                                         k<br />      Move around:  Use the cursor keys, or "h" to go left,            h   l<br />                    "j" to go down, "k" to go up, "l" to go right.       j<br />Close this window:  Use ":q&lt;Enter&gt;".<br />   Get out of Vim:  Use ":qa!&lt;Enter&gt;" (careful, all changes are lost!).<br /></pre><br />Andiamo bene! L'help in linea suggerisce di uscire dall'editor con <code>:qa!</code>, in sostanza l'equivalente di una <code>kill -9</code>!<br /><br /><br />Eppure ci sono alcuni modi molto piu' furbi di uscire da Vi senza rischiare di perdere i dati, e il mio preferito è quello di usare <code>ZZ</code> che esce <i>salvando se necessario</i> le modifiche. Perché questa cosa è importante? Perché forzare un aggiornamento del file ad ogni&nbsp; <i>uscita</i> ne cambia il timestamp e potrebbe creare conflitti con strumenti di controllo delle versioni e di build automatico.<br />Ma non solo, se si digita <code>:help :x</code> si scopre che:<br /><br /><br /><pre class="example">*:x* *:xit*<br />                        Like ":wq", but write only when changes have been<br />                        made.<br /><br />ZZ                      Write current file, if modified, and quit (same as<br />                        ":x").  (Note: If there are several windows for the<br />                        current file, the file is written if it was modified<br />                        and the window is closed).<br /></pre><br />Mettiamo ora a confronto le varie modalità:<br /><br /><br /><table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups"> <colgroup><col class="left"></col> <col class="right"></col> <col class="left"></col></colgroup><thead><tr><th class="left" scope="col">comando</th><th class="right" scope="col">caratteri</th><th class="left" scope="col">rischio di perdita modifiche</th></tr></thead><tbody><tr><td class="left">:qa!</td><td class="right">4</td><td class="left">si</td></tr><tr><td class="left">:wq!</td><td class="right">4</td><td class="left">no</td></tr><tr><td class="left">ZZ</td><td class="right">3 (contando SHIFT)</td><td class="left">no</td></tr><tr><td class="left">:x</td><td class="right">2</td><td class="left">no</td></tr></tbody></table><br /><br />Quindi perché non istruire gli utenti <span class="underline">da subito</span> ad usare modalità di uscita <i>smart</i>, visto che risultano perfino piu' compatte (in termini di caratteri) rispetto a quelle <i>brutali</i>?<br />