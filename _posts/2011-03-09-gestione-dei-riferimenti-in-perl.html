---
layout: post
title: Gestione dei riferimenti in Perl
date: '2011-03-09T22:20:00.001+01:00'
author: Luca Ferrari
tags:
- perl
modified_time: '2011-03-09T22:20:55.102+01:00'
blogger_id: tag:blogger.com,1999:blog-1836481905487384887.post-975767508461605993
blogger_orig_url: http://fluca1978.blogspot.com/2011/03/gestione-dei-riferimenti-in-perl.html
---

<div style="text-align: justify;">La gestione dei riferimenti in Perl è spesso oggetto di errori e discussioni, perciò ho ritenuto interessante elencare come possono essere gestiti i riferimenti dal punto di vista sintattico.</div><div style="text-align: justify;">In Perl un riferimento è un valore scalare, concettualmente assimilabile al puntatore del linguaggio C. I riferimenti possono "puntare" ad un array o un hash, e possono essere a loro volta organizzati in array o hash e quindi permettono la creazione di strutture dati complesse (array di array, hash di array, hash di hash, array di hash, ...).</div><div style="text-align: justify;">Il riferimento ad una struttura dati (hash o array) non anonima si ottiene mediante l'operatore backslash (\), concettualmente simile all'operatore &amp; del linguaggio C. Essendo un riferimento un valore scalare, il suo valore viene estratto sempre usando il dollaro ($), ossia il riferimento è sempre usato come una normale variabile scalare. Il valore di un riferimento corrisponde al valore del puntatore, ossia alla dereferenziazione del riferimento stesso. Occorre prestare un po' di attenzione ad alcune regole sintattiche quando si lavora con i riferimenti, siano essi ad array o hash. Come regola generale, sempre valida, si può assumere che la dereferenziazione di un riferimento ha sempre la sintassi <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">${ $nome_riferimento }</span> ossia è come se si avesse l'estrazione del valore del riferimento (<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$nome_riferimento</span>) a sua volta estratto ancora. Si può pensare che <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">${ }</span> corrisponda, in Perl, all'operatore * del C (inteso come operatore di "contenuto del puntatore").</div><div style="text-align: justify;">In generale quindi vale la regola che ovunque si scriverebbe il nome dell'array o dell'hash referenziato si debba inserire <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">{ $nome_riferimento }</span>. Un esempio chiarira' meglio questo aspetto: si supponga di avere un array <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">@array</span> e il suo riferimento <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$refToArray</span> e si voglia accedere alla sua cella i-esima. La sintassi diventa:</div><div style="text-align: justify;"><br /></div><ul style="text-align: justify;"><li>accesso diretto <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$array[ $i ]</span></li><li>accesso tramite riferimento <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">${ $refToarray }[ $i ]</span></li></ul><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Come si può notare, da un punto di vista sintattico "array" è stato sostituito completamente da "<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">{refToArray }</span>". Questa regola è sempre valida, e quindi la sua applicazione non produce mai errori. E' comunque possibile semplificare ulteriormente la notazione tenendo conto che:</div><ul style="text-align: justify;"><li>se <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$refToArray</span> è un valore scalare puro allora le parentesi graffe possono essere rimosse, e quindi <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">${ $refToArray }[ $i ]</span> diventa <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$$refToArray[ $i ]</span>;</li><li>se la dereferenziazione punta ad un valore scalare, allora <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">${ REF }[ $i ]</span> puo' essere convertito nella notazione "frecciata" <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$REF-&gt;[$i]</span>. Questa notazione verra' denominata nel seguito "riferimento smart".</li></ul><div style="text-align: justify;">Si consideri ora un esempio di codice che riassume le sintassi e le confronta nel caso di array:</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># creazione di un array normale</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">@array = ( 1, 2, 3, 4, 5);</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># creo un riferimento (scalare) all'array</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$refToArray = \@array;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># estraggo i dati dell'array</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">print "\nEstrazione dati da array";</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">for( $i = 0; $i &lt;= $#array; $i++ ){</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $i ] tramite valore&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = " . $array[ $i ];</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $i ] tramite riferimento&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = " . ${ $refToArray }[ $i ];</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $i ] tramite riferimento&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = " . $$refToArray[ $i ];</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $i ] tramite riferimento smart = " . $refToArray-&gt;[ $i ];</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">}</span></span>considerazioni fatte per l'array valgono anche nel caso di un hash. Come detto prima, ogni volta che si inserisce il nome dell'hash si può inserire <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">{ $refToHash }</span>:</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span style="font-size: x-small;"><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># creo un hash</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">%hash = ( "key1" =&gt; "value1",</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp; "key2" =&gt; "value2",</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp; "key3" =&gt; "value3",</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">);</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># creo un riferimento ad un hash</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$refToHash = \%hash;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># estraggo i dati dall'hash</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">print "\nEstrazione dati hash";</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">foreach $key ( keys( %hash ) ){</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $key ] tramite valore&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = " . $hash{ $key };</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $key ] tramite riferimento&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = " . ${ $refToHash }{ $key };</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $key ] tramite riferimento smart = " . $refToHash-&gt;{ $key };</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">}</span></span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">E' possibile usare i riferimenti anche per la creazione di hash e array anonimi, ossia senza un nome di variabile ma che vengono acceduti solo tramite un riferimento. In questo caso non si usa l'operatore backslash (\) ma rispettivamente:</div><ul style="text-align: justify;"><li>[] per definire un riferimento ad una lista/array;</li><li>{} per definire un riferimento ad un hash.</li></ul><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Il seguente pezzo di codice mostra come creare riferimenti ad hash e array anonimi, con il relativo accesso ai dati. Si noti ancora una volta come, ovunque sarebbe comparso il nome ipotetico dell'hash, si sia provveduto a sostituire tale nome con il valore scalare del riferimento.</div><div style="text-align: justify;"><br /></div><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># creazione di un array tramite riferimento</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$refToArray = [ "a", "b", "c", "d" ];</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">for( $i = 0; $i &lt;= $#$refToArray; $i++ ){</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $i ] tramite riferimento&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = " . ${ $refToArray }[ $i ];</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $i ] tramite riferimento smart = " . $refToArray-&gt;[ $i ];</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">}</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># creazione di un hash tramite riferimento</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">$refToHash = {</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; "key1" =&gt; "value1",</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; "key2" =&gt; "value2",</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; "key3" =&gt; "value3",</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">};</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">foreach $key ( keys( %${refToHash} ) ){</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $key ] tramite valore&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = " . $hash{ $key };</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $key ] tramite riferimento&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = " . ${ $refToHash }{ $key };</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; print "\n [ $key ] tramite riferimento smart = " . $refToHash-&gt;{ $key };</span></span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">}</span></span>