---
layout: post
title: 'Java Comparable: usare indici con peso'
date: '2011-03-29T20:00:00.000+02:00'
author: Luca Ferrari
tags:
- java
modified_time: '2011-03-29T20:00:02.611+02:00'
blogger_id: tag:blogger.com,1999:blog-1836481905487384887.post-7277462171573650497
blogger_orig_url: http://fluca1978.blogspot.com/2011/03/java-comparable-usare-indici-con-peso.html
---

<div style="text-align: justify;">Java dispone dell'interfaccia Comparable per permette la comparazione e l'ordinamento di oggetti in memoria. L'idea e' semplice: se un oggetto e' Comparable viene invocato un metodo particolare che deve restituire un valore positivo, negativo o nullo rispettivamente per sapere se tale oggetto e' "maggiore", "minore" o uguale a quello che si sta correntemente esaminando. La specifica pero' non pone nessun vincolo su quanto positivo o negativo debba essere un valore affinche' la comparazione sia valutata, e questo lascia ampio spazio di manovra ai programmatori per implementare in maniera semplice ed efficace i controlli di comparazione.<br />Si supponga ad esempio di avere un oggetto Document che debba essere ordinato per anno e mese. Il test formale prevede di controllare anzitutto gli anni di due documenti, e se questi coincidono, i rispettivi mesi. Quindi qualcosa di simile a:</div><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">public int compareTo(Document toCompare) {</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; // controllo argomenti</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; if( toCompare == null )</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return 1;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; if( getYear() == toCompare.getYear() ){</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // controllo mesi</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if( getMonth() &gt; toCompare.getMonth() )</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return 1;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else if( getMonth() &lt; toCompare.getMonth() )</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -1;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; }</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if( getYear() &gt; toCompare.getYear() )</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 1;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; return 0;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">}</span></span><br /><br /><div style="text-align: justify;">In effetti il test effettuato con if/else e' abbastanza articolato e ricontrolla in vari punti condizioni simili. E' possibile ovviare a tutto quel codice considerando semplicemente che le due condizioni da testare (anno e mese) hanno pesi diversi: l'anno pesa di piu' (ossia una differenza fra gli anni e' discriminante indipendentemente dalla differenza fra i mesi), e quindi e' possibile calcolare un valore complessivo dato dalla differenza pesata fra i valori. Considerando che la differenza fra i mesi e' compresa fra -12 e +12 e' sufficiente che la differenza fra gli anni sia sempre maggiore a tale intervallo, e quindi:</div><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">public int compareTo(Document toCompare) {</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; // controllo argomenti</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; if( toCompare == null )</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return 1;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; int equality = 0;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // per default i due documenti sono uguali</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; equality += ( getYear() - toCompare.getYear() ) * 100;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; equality += ( getMonth() - toCompare.getMonth() );</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; return equality;</span><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><br style="font-family: &quot;Courier New&quot;,Courier,monospace;" /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">}</span></span><br /><br /><br /><div style="text-align: justify;">In questo modo una differenza fra gli anni sara' sempre superiore ad una differenza fra i mesi, che quindi sara' non considerata a meno che i due anni non risultino uguali.<br />In conclusione, considerando i range di differenza dei valori meno filtranti e' possibile costruire un semplice meccanismo di comparazione basato sulla sola differenza pesata dei valori stessi.</div>