---
layout: post
title: Usare lo stesso UID fra account differenti
date: '2013-03-30T13:55:00.000+01:00'
author: Luca Ferrari
tags:
- linux
- freebsd
modified_time: '2013-03-30T13:55:01.001+01:00'
blogger_id: tag:blogger.com,1999:blog-1836481905487384887.post-8072200464746583277
blogger_orig_url: http://fluca1978.blogspot.com/2013/03/usare-lo-stesso-uid-fra-account.html
---

<div style="text-align: justify;">Alcuni sistemi Unix, come ad esempio FreeBSD, forniscono effettivamente due utenti root: il classico <i>root</i> e il suo rovesciato <i>toor</i>. Per verificare la presenza di questi due utenti e' sufficiente usare il seguente comando:</div><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">% grep "^[rt]oo[rt]:" /etc/passwd</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">root:*:0:0:Charlie &amp;:/root:/bin/csh</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">toor:*:0:0:Bourne-again Superuser:/root:</span><br /><br /><div style="text-align: justify;">L'idea e' semplice: <i>root</i> e' l'utente impostato all'atto dell'installazione e non dovrebbe mai essere personalizzato (ad esempio modificandone la shell), al fine di garantire che in situazioni estreme (es. single user mode) l'account funzioni come ci si aspetta (o meglio come si aspetta il sistema). Il suo rovescio, <i>toor</i>, e' invece un account che puo' essere personalizzato ad esempio impostando una shell differente (presa da /usr e non disponibile in single user mode).</div><div style="text-align: justify;">Si noti che i due account condividono lo stesso UID (0) e quindi sono di fatto lo stesso account, solo con entry differenti nei vari database.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Oggi giorno non esiste piu' la reale necessita' di usare una simile tecnica, grazie a strumenti come sudo che consentono una personalizzazione di account utente normali estrema. Alcune distribuzioni Linux non forniscono nemmeno un account root disponibile, forzando l'utente a configurare sudo.</div><div style="text-align: justify;">Ancora oggi pero' qualcuno e' tentato da usare questa tecnica dei doppi account per separare privilegi, personalizzazioni, ecc. La mia risposta breve e': <i>NON FATELO</i>!</div><div style="text-align: justify;">In generale potrebbero esserci applicazioni che, stupidamente, ritengono che un UID sia unico. E queste si riveleranno sicuramente come una falla di sicurezza. Dopotutto, la generazione di /etc/passwd da /etc/master.passwd non e' per via di alcune applicazioni "stupide" che richiedono accesso al database degli utenti?</div><div style="text-align: justify;">In secondo luogo, il sistema potrebbe confondersi, non facendovi vedere chi ha creato quali file:</div><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># id</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">uid=0(root) gid=0(wheel) groups=0(wheel),5(operator)</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">root@fb91:/root # touch test.txt</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">root@fb91:/root # ls -l test.txt</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">-rw-r--r--  1 root  wheel  0 test.txt</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></span><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># su - toor</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># touch test2.txt</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># ls -l test2.txt</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">-rw-r--r--  1 root  wheel  0 Mar test2.txt</span><br /><br /><div style="text-align: justify;">L'ownership dei file viene presa assumendo il primo record che si trova nel database (forse ls e' da considerarsi una applicazione stupida? In realta' non saprebbe come fare a discriminare gli utenti). Quindi condividere utenti/privilegi con questo metodo vi fa perdere, gratis e con effetto immediato, la tracciabilita' di quale utente ha toccato quali file.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">La strada corretta per gestire in sicurezza i privilegi e' usare <i>sudo</i>.</div>